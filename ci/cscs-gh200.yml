include:
  - remote: 'https://gitlab.com/cscs-ci/recipes/-/raw/master/templates/v2/.ci-ext.yml'

unit_test:
  extends: .uenv-runner-daint-gh200
  image: julia/25.5:v1
  script:
  - julia -e 'println("Instantiating project");
              using Pkg;
              Pkg.develop(; path=pwd())'
  - julia -e 'println("Running tests");
              using Pkg;
              Pkg.test("Chmy"; test_args=["--backend=CUDA"])'
  variables:
    WITH_UENV_VIEW: 'juliaup'
    SLURM_JOB_NUM_NODES: 1
    SLURM_NTASKS_PER_NODE: 1
    SLURM_GPUS_PER_TASK: 1
    SLURM_TIMELIMIT: "00:15:00"
